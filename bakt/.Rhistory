library(tidyverse)
library(clusterProfiler)
library(org.Hs.eg.db)
library(DOSE)
library(enrichplot)
eczv <- read_tsv('bakt_files/ECZV.tsv', skip=2) %>% janitor::clean_names()
ids <- read_lines('narna_ids.txt')
eczv %>% dplyr::filter(gene=='naRNA4') %>% dplyr::filter(strand=='+')
#Решение, где соседними считаются соседние гены в таблице без разделени на strands
idxes <- which(eczv$gene == 'naRNA4')
nd <- 1 #neighbor distance
keytypes(org.Hs.eg.db)
eczv$gene
bitr(eczv$gene, fromType="SYMBOL",
toType="ENTREZID",
OrgDb="org.Hs.eg.db")
keys(org.Hs.eg.db)
keytypes(org.Hs.eg.db)
bitr(eczv$gene, fromType="GENENAME",
toType="ENTREZID",
OrgDb="org.Hs.eg.db")
eczv$gene
View(eczv)
head(eczv)
eczv <- read_tsv('bakt_files/ECZV.tsv', skip=2) %>% janitor::clean_names()
library(biomaRt)
listEnsembl()
listEnsemblGenomes()
ensembl_bacteria <- useEnsemblGenomes(biomart = "bacteria_mart")
? listMarts
listMarts()
BiocManager::install('org.EcK12.eg.db')
library(org.EcK12.eg.db)
bitr(eczv$gene, fromType="GENENAME",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
keytypes(org.EcK12.eg.db)
bitr(eczv$gene, fromType="SYMBOL",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
keytypes(org.EcK12.eg.db)
bitr('naRNA4', fromType="SYMBOL",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
bitr(eczv$gene, fromType="ACCNUM",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
bitr(eczv$gene, fromType="ALIAS",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
keytypes(org.EcK12.eg.db)
bitr(eczv$gene, fromType="ENZYME",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
bitr(eczv$gene, fromType="EVIDENCE",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
bitr(eczv$gene, fromType="EVIDENCEALL",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
bitr(eczv$gene, fromType="GENENAME",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
bitr(eczv$gene, fromType="GO",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
bitr(eczv$gene, fromType="GOALL",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
bitr(eczv$gene, fromType="ONTOLOGY",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
?bitr
bitr(eczv$gene, fromType="REFSEQ",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
bitr(eczv$gene, fromType="SYMBOL",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
bitr(eczv$gene, fromType="ALIAS",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
colnames(bitr1)
bitr1 <- bitr(eczv$gene, fromType="ALIAS",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
bitr1 <- bitr(eczv$gene, fromType="ALIAS",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
colnames(bitr1)
bitr2 <- bitr(eczv$gene, fromType="ALIAS",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
class(bitr1)
bitr1
head(bitr1)
head(bitr2)
bitr1 <- bitr(eczv$gene, fromType="ALIAS",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
bitr2 <- bitr(eczv$gene, fromType="SYMBOL",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db")
head(bitr2)
head(bitr1)
?left_join
dim(bitr1)
dim(bitr2)
?>rename
?rename
colnames(eczv)
bitr(eczv$gene, fromType="ALIAS",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename("ALIAS" = 'gene') %>% right_join(eczv, by='gene')
bitr(eczv$gene, fromType="ALIAS",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "ALIAS") %>% right_join(eczv, by='gene')
jointed <- bitr(eczv$gene, fromType="ALIAS",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "ALIAS") %>% right_join(eczv, by='gene')
View(jointed)
bitr(eczv$gene, fromType="ALIAS",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "ALIAS")
jointed <- bitr(eczv$gene, fromType="SYMBOL",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "SYMBOL") %>% right_join(jointed, by='gene')
jointed$ENTREZID.x == jointed$ENTREZID.y
jointed$ENTREZID.x == jointed$ENTREZID.y %>% table
table(jointed$ENTREZID.x == jointed$ENTREZID.y)
!(jointed$ENTREZID.x == jointed$ENTREZID.y)
jointed$ENTREZID.x[!(jointed$ENTREZID.x == jointed$ENTREZID.y)]
jointed$ENTREZID.y[!(jointed$ENTREZID.x == jointed$ENTREZID.y)]
with_id <- jointed %>% mutate(ENTREZID=coalesce(ENTREZID.x, ENTREZID.y))
View(with_id)
eczv$number_sequence_id %>% unique()
with_id <- jointed %>% mutate(ENTREZID=coalesce(ENTREZID.x, ENTREZID.y)) %>% select(c(5:10, 1, 12))
with_id <- jointed %>% mutate(ENTREZID=coalesce(ENTREZID.x, ENTREZID.y)) %>% dplyr::select(c(5:10, 1, 12))
eczv <- read_tsv('bakt_files/ECZV.tsv', skip=2) %>% janitor::clean_names()
ids <- read_lines('narna_ids.txt')
#добавление ID
ensembl_bacteria <- useEnsemblGenomes(biomart = "bacteria_mart")
eczv <- read_tsv('bakt_files/ECZV.tsv', skip=2) %>% janitor::clean_names()
ids <- read_lines('narna_ids.txt')
#добавление ID
jointed <- bitr(eczv$gene, fromType="ALIAS",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "ALIAS") %>% right_join(eczv, by='gene')
jointed <- bitr(eczv$gene, fromType="SYMBOL",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "SYMBOL") %>% right_join(jointed, by='gene')
eczv_with_id <- jointed %>% mutate(ENTREZID=coalesce(ENTREZID.x, ENTREZID.y)) %>% dplyr::select(c(5:10, 1, 12))
View(eczv_with_id)
#Левые и правые соседи на всех стрендах
idxes <- which(eczv_with_id$gene == 'naRNA4')
idxes
idxes %>% length()
nd <- 1 #neighbor distance
right_neighbors <- eczv_with_id %>% dplyr::slice((-nd:-1)+idxes) %>% dplyr::filter(gene!='naRNA4')
right_neighbors <- eczv_with_id %>% dplyr::slice((-nd:-1)+idxes) %>% dplyr::filter(gene!='naRNA4')
left_neighbors <- eczv_with_id %>% dplyr::slice((1:nd)+idxes) %>% dplyr::filter(gene!='naRNA4')
View(left_neighbors)
View(right_neighbors)
idxes
(1:nd)+idxes
eczv_with_id %>% dplyr::slice((1:nd)+idxes)
keytypes()
keytypes(org.EcK12.eg.db)
jointed <- bitr(eczv$gene, fromType="ALIAS",
toType="REFSEQ",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "ALIAS") %>% right_join(eczv, by='gene')
jointed <- bitr(eczv$gene, fromType="SYMBOL",
toType="REFSEQ",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "SYMBOL") %>% right_join(jointed, by='gene')
eczv_with_id <- jointed %>% mutate(REFSEQ=coalesce(REFSEQ.x, REFSEQ.y)) %>% dplyr::select(c(5:10, 1, 12))
#Левые и правые соседи на всех стрендах
idxes <- which(eczv_with_id$gene == 'naRNA4')
nd <- 1 #neighbor distance
#eczv_with_id %>% dplyr::slice(unique(sort(c((-nd:-1)+idxes, (1:nd)+idxes)))) %>% dplyr::filter(gene!='naRNA4')
right_neighbors <- eczv_with_id %>% dplyr::slice((-nd:-1)+idxes) %>% dplyr::filter(gene!='naRNA4')
left_neighbors <- eczv_with_id %>% dplyr::slice((1:nd)+idxes) %>% dplyr::filter(gene!='naRNA4')
jointed <- bitr(eczv$gene, fromType="ALIAS",
toType="GO",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "ALIAS") %>% right_join(eczv, by='gene')
jointed <- bitr(eczv$gene, fromType="SYMBOL",
toType="GO",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "SYMBOL") %>% right_join(jointed, by='gene')
eczv_with_id <- jointed %>% mutate(GO=coalesce(GO.x, GO.y)) %>% dplyr::select(c(5:10, 1, 12))
#Левые и правые соседи на всех стрендах
idxes <- which(eczv_with_id$gene == 'naRNA4')
nd <- 1 #neighbor distance
#eczv_with_id %>% dplyr::slice(unique(sort(c((-nd:-1)+idxes, (1:nd)+idxes)))) %>% dplyr::filter(gene!='naRNA4')
right_neighbors <- eczv_with_id %>% dplyr::slice((-nd:-1)+idxes) %>% dplyr::filter(gene!='naRNA4')
left_neighbors <- eczv_with_id %>% dplyr::slice((1:nd)+idxes) %>% dplyr::filter(gene!='naRNA4')
?bitr
bitr(eczv$gene, fromType="ALIAS",
toType="GO",
OrgDb="org.EcK12.eg.db")
#добавление ID
jointed <- bitr(eczv$gene, fromType="ALIAS",
toType="REFSEQ",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "ALIAS") %>% right_join(eczv, by='gene')
jointed <- bitr(eczv$gene, fromType="SYMBOL",
toType="REFSEQ",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "SYMBOL") %>% right_join(jointed, by='gene')
eczv_with_id <- jointed %>% mutate(REFSEQ=coalesce(REFSEQ.x, REFSEQ.y)) %>% dplyr::select(c(5:10, 1, 12))
#Левые и правые соседи на всех стрендах
idxes <- which(eczv_with_id$gene == 'naRNA4')
nd <- 1 #neighbor distance
#eczv_with_id %>% dplyr::slice(unique(sort(c((-nd:-1)+idxes, (1:nd)+idxes)))) %>% dplyr::filter(gene!='naRNA4')
right_neighbors <- eczv_with_id %>% dplyr::slice((-nd:-1)+idxes) %>% dplyr::filter(gene!='naRNA4')
left_neighbors <- eczv_with_id %>% dplyr::slice((1:nd)+idxes) %>% dplyr::filter(gene!='naRNA4')
idxes <- which(eczv_with_id$gene == 'naRNA4')
nd <- 3 #neighbor distance
#eczv_with_id %>% dplyr::slice(unique(sort(c((-nd:-1)+idxes, (1:nd)+idxes)))) %>% dplyr::filter(gene!='naRNA4')
right_neighbors <- eczv_with_id %>% dplyr::slice((-nd:-1)+idxes) %>% dplyr::filter(gene!='naRNA4')
left_neighbors <- eczv_with_id %>% dplyr::slice((1:nd)+idxes) %>% dplyr::filter(gene!='naRNA4')
(-nd:-1)+idxes
nd <- 1 #neighbor distance
(-nd:-1)+idxes
(-3:-1)+idxes
(-3:-1)
idxes
outer((-3:-1),idxes, '+')
outer((-3:-1),idxes, '+') %>% as.vector()
outer((-3:-1),idxes, '+') %>% as.vector() %>% unique()
outer((-3:-1),idxes, '+') %>% as.vector() %>% unique() %>% sort()
#eczv_with_id %>% dplyr::slice(unique(sort(c((-nd:-1)+idxes, (1:nd)+idxes)))) %>% dplyr::filter(gene!='naRNA4')
right_neighbors <- eczv_with_id %>% dplyr::slice(outer((1:nd),idxes, '+') %>% dplyr::filter(gene!='naRNA4')
1
left_neighbors <- eczv_with_id %>% dplyr::slice(outer((-nd:-1),idxes, '+') %>% as.vector()) %>% dplyr::filter(gene!='naRNA4')
#eczv_with_id %>% dplyr::slice(unique(sort(c((-nd:-1)+idxes, (1:nd)+idxes)))) %>% dplyr::filter(gene!='naRNA4')
right_neighbors <- eczv_with_id %>% dplyr::slice(outer((1:nd),idxes, '+') %>% as.vector())%>% dplyr::filter(gene!='naRNA4')
outer((1:nd),idxes, '+') %>% as.vector()
eczv_with_id %>% dplyr::slice(outer((1:nd),idxes, '+') %>% as.vector())%>% dplyr::filter(gene!='naRNA4')
outer((1:nd),idxes, '+') %>% as.vector()
length(outer((1:nd),idxes, '+') %>% as.vector())
nd <- 3 #neighbor distance
#eczv_with_id %>% dplyr::slice(unique(sort(c((-nd:-1)+idxes, (1:nd)+idxes)))) %>% dplyr::filter(gene!='naRNA4')
right_neighbors <- eczv_with_id %>% dplyr::slice(outer((1:nd),idxes, '+') %>% as.vector())%>% dplyr::filter(gene!='naRNA4')
outer((1:nd),idxes, '+') %>% as.vector()
outer((1:nd),idxes, '+') %>% as.vector() %>% length()
eczv_with_id %>% dplyr::slice(outer((1:nd),idxes, '+') %>% as.vector())
View(outer((1:nd),idxes, '+') %>% as.vector())
View(eczv_with_id %>% dplyr::slice(outer((1:nd),idxes, '+') %>% as.vector()))
library(tidyverse)
library(clusterProfiler)
library(DOSE)
library(enrichplot)
library(biomaRt)
library(org.EcK12.eg.db)
eczv <- read_tsv('bakt_files/ECZV.tsv', skip=2) %>% janitor::clean_names()
ids <- read_lines('narna_ids.txt')
#добавление ID
jointed <- bitr(eczv$gene, fromType="ALIAS",
toType="REFSEQ",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "ALIAS") %>% right_join(eczv, by='gene')
jointed <- bitr(eczv$gene, fromType="SYMBOL",
toType="REFSEQ",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "SYMBOL") %>% right_join(jointed, by='gene')
eczv_with_id <- jointed %>% mutate(REFSEQ=coalesce(REFSEQ.x, REFSEQ.y)) %>% dplyr::select(c(5:10, 1, 12))
#Левые и правые соседи на всех стрендах
idxes <- which(eczv_with_id$gene == 'naRNA4')
nd <- 3 #neighbor distance
#eczv_with_id %>% dplyr::slice(unique(sort(c((-nd:-1)+idxes, (1:nd)+idxes)))) %>% dplyr::filter(gene!='naRNA4')
right_neighbors <- eczv_with_id %>% dplyr::slice(outer((1:nd),idxes, '+') %>% as.vector())%>% dplyr::filter(gene!='naRNA4')
left_neighbors <- eczv_with_id %>% dplyr::slice(outer((-nd:-1),idxes, '+') %>% as.vector()) %>% dplyr::filter(gene!='naRNA4')
View(left_neighbors)
eczv_with_id %>% pull(REFSEQ) %>% is.na() %>% table()
951/(4032+951)
c(left_neighbors$type, right_neighbors$type) %>% table()
keytypes(org.EcK12.eg.db)
library(biomaRt)
#mart
mart <- useMart("ENSEMBL_MART_ENSEMBL", dataset="ecoli_str_k_12_substr_mg1655_gene_ensembl", host="https://bacteria.ensembl.org")
listDatasets(useMart('ensembl'))
listDatasets(useMart('ensembl')) %>% grep('coli', .)
listDatasets(useMart('ensembl')) %>% class()
BiocManager::install("Rfam")
eczv <- read_tsv('bakt_files/ECZV.tsv', skip=2) %>% janitor::clean_names()
ids <- read_lines('narna_ids.txt')
#добавление ID
jointed <- bitr(eczv$gene, fromType="ALIAS",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "ALIAS") %>% right_join(eczv, by='gene')
jointed <- bitr(eczv$gene, fromType="SYMBOL",
toType="ENTREZID",
OrgDb="org.EcK12.eg.db") %>% dplyr::rename('gene' = "SYMBOL") %>% right_join(jointed, by='gene')
eczv_with_id <- jointed %>% mutate(ENTREZID=coalesce(ENTREZID.x, ENTREZID.y)) %>% dplyr::select(c(5:10, 1, 12))
idxes <- which(eczv_with_id$gene == 'naRNA4')
nd <- 3 #neighbor distance
#eczv_with_id %>% dplyr::slice(unique(sort(c((-nd:-1)+idxes, (1:nd)+idxes)))) %>% dplyr::filter(gene!='naRNA4')
right_neighbors <- eczv_with_id %>% dplyr::slice(outer((1:nd),idxes, '+') %>% as.vector())%>% dplyr::filter(gene!='naRNA4')
left_neighbors <- eczv_with_id %>% dplyr::slice(outer((-nd:-1),idxes, '+') %>% as.vector()) %>% dplyr::filter(gene!='naRNA4')
BiocManager::install("Rfam")
devtools::install_github("r-dbi/RSQLite")
install.packages('devtools')
